---
title: "Sprawozdanie"
author: "Olga Sieradzan, Justyna Sarkowicz, Weronika Duda, Amelia Madej, Aleksandra Węgrzyn"
date: "2025-01-09"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: 
      collapsed: true
      smooth_scroll: true
    toc_font: "Arial"
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


```{r}
library(dplyr)
library(cowplot)
library(ggplot2)
library(readr)
database <- read_csv("msft_us_historical_data.csv")

```


# Wprowadzenie 

<div style='text-align: justify'>
Umiejętność przewidywania zachowań spółek na giełdzie oraz identyfikacji spadków i wzrostów jest kluczową kompetencją współczesnych algorytmów działających na giełdzie. Szeroka gama narzędzi wspomaga maklerów w podejmowaniu decyzji o środkach, którymi obracają. W tej dziedzinie niezwykle pomocne okazują się sieci neuronowe, które są szeroko wykorzystywane do prognozowania cen na giełdzie.

<div style='text-align: justify'>
W ramach badania postanowiono zbadać działanie rekurencyjnych sieci neuronowych (LSTM) na danych dotyczących notowań giełdowych spółki Microsoft od roku 2010. Zbiór treningowy stanowi 80% danych, natomiast działanie modelu jest testowane na ostatnich 20% danych.

<div style='text-align: justify'>
Modele LSTM zależą od dużej liczby parametrów, a ich dobór ma istotny wpływ na wyniki. W badaniu postanowiono zbadać wpływ 5 różnych parametrów, testując przy każdym z nich 4 różne wartości.

Sprawdzanymi parametrami są; 

* **Funkcja aktywacji** - mechanizm który decyduje o tym jakie informacje mają zostac podane dalej w sieci, a które mają zostać zapomniane. 

  *Badane wartości: f.liniowa, f.sigmondalna, f.relu, f.tangens hiberboliczny(tanh)*

* **Rozmiar partii** - liczba próbek, które są przetważane przez model w jednym przebiegu podczas uczenia. Wielkość partii znacząco wpływa na aktualizacje wag w trakcie treningu.

  *Badane wartości: 16, 32, 64, 128*

* **Liczba wartstw** - liczba poziomów przez które przechodzą dane w trakcie prztwarzania. Im wiecej takich warstw tym głębsze są sieci. 

  *Badane wartości: 2, 3, 4, 5*

* **Liczba neuronów** - ilość neuronów w pojedyńczej warstwie. W neuronie przetważane są informacje sieci za pomocą wybranych funkcji aktywacyjnych i przekazywane dalej.

  *Badane wartości: 50, 100, 150, 200*

* **Optymalizator** - algorytm działający w celu optymalizacji wag sieci aby minimaliozwać błąd predykcji. 

  *Badane wartości: Adam, RMSprop, SGD, Adagrad*

# Opis danych 

Firma Microsoft została wybrana do badania ze względu na popularność spółki (przynależnośc do wielkiej piątki), i co za tym idzie, dużą ilość publikacji w związku z tą spółką. 

```{r}
split_index <- floor(0.8 * nrow(database))
split_date <- database$Date[split_index]

database %>%
  ggplot()+
  geom_line(aes(x = Date, y = Close)) +
  geom_vline(xintercept = as.numeric(split_date), color = "red", linetype = "dashed", size = 1) + 
  
  theme_light(base_size = 15) +
  
  labs( title= "Microsoft - notowania na giełdzie", y = "Cena zamknięcia", x = "Data")
```

Na wykresie można zauważyć dane na których działano w badaniu. Czerwona linia zaznacza 80% danych, czyli po lewej stronie lini jest zbiór treningowy, natomiast po prawej stronie lini widac zbiór testowy.
























